import os
import sys

Import('base_env')

#######################################################
# Setup GoogleTest/GoogleMock automated test environment
#######################################################
build_dir = base_env['build_dir'] + '/test'

env = base_env.Clone(automated_tests = [],
                     build_dir = build_dir,
                     install_bindir = '$install_basedir/test')

if env['native_build'] and env['PRODUCTION']:
    env['ENV']['LD_LIBRARY_PATH'] = ':'.join([ os.environ['LD_LIBRARY_PATH'],
                                               str(env.Dir(env['install_libdir'])) ] )

#######################################################
# Setup/build Google Mock and Google Test
#######################################################
SConscript('SConscript.gtool', variant_dir = build_dir + '/gtool', exports = ['env'], duplicate = 0)


Return('env')
